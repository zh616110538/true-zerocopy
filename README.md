# True Zero copy #

## Background ##

DDS在进程间通信时的zero copy只能支持POD类型，对于C++开发非常不友好。  
一般开发过程中会使用大量的C++数据结构，走共享内存通信时会先序列化一次变成一段数组结构，然后拷贝到共享内存中，再由接收方反序列化后拷贝到自己的地址空间。此过程至少经历两次拷贝，非常影响效率。

## Principles ## 

在共享内存之上实现一个多进程共享的allocator，对于C++的每一种数据结构都用该allcator进行数据new/delete  
假设进程P1有一个数据结构std::vector，使用共享内存的alloctor进行内存地址分配，假设实际内存地址为R，虚拟地址为v，进程为p，则R1=m(v1, p1)。现在要与进程P2进行通信，需要做的事即为R1=m(v2, p2)，在P2中看到的虚拟地址指向的物理地址即和P1虚拟地址对应的物理地址相同，即可实现零拷贝零序列化的通信。